!function(u){"use strict";function e(){}function s(e){return function(){return e}}function n(){return A}function r(e){return e.isNone()}function t(e){return e()}function o(e){return e}function i(n){return function(e){return function(e){if(null===e)return"null";var n=typeof e;return"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(e)===n}}function a(e,n,r,t,o){return e(r,t)?M.some(r):H(o)&&o(r)?M.none():n(r,t,o)}function c(e,n){function r(e){return Number(n.replace(t,"$"+e))}var t=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}return undefined}(e,n);return t?fe(r(1),r(2)):{major:0,minor:0}}function f(e,n){return function(){return n===e}}function d(e,n){return function(){return n===e}}function l(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return M.some(o)}return M.none()}(e,function(e){return e.search(r)})}function m(e,n){return-1!==e.indexOf(n)}function g(n){return function(e){return m(e,n)}}function h(e,n){var r=e.dom();if(r.nodeType!==De)return!1;var t=r;if(t.matches!==undefined)return t.matches(n);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(n);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(n);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function v(e,n,r){for(var t=e.dom(),o=H(r)?r:s(!1);t.parentNode;){t=t.parentNode;var i=q.fromDom(t);if(n(i))return M.some(i);if(o(i))break}return M.none()}function p(e,n,r){return v(e,function(e){return h(e,n)},r)}var b,O=tinymce.util.Tools.resolve("tinymce.PluginManager"),N=0,E=function(e,n,r){var t,o,i;e.plugins.table?e.plugins.table.insertTable(n,r):(o=n,i=r,(t=e).undoManager.transact(function(){var e,n;t.insertContent(function(e,n){var r,t,o;for(o='<table data-mce-id="mce" style="width: 100%">',o+="<tbody>",t=0;t<n;t++){for(o+="<tr>",r=0;r<e;r++)o+="<td><br></td>";o+="</tr>"}return(o+="</tbody>")+"</table>"}(o,i)),(e=t.dom.select("*[data-mce-id]")[0]).removeAttribute("data-mce-id"),n=t.dom.select("td,th",e),t.selection.setCursorLocation(n[0],0)}))},w=function(e,n,r){var t,o,i,u;o=(t=e.editorUpload.blobCache).create((i="mceu",u=(new Date).getTime(),i+"_"+Math.floor(1e9*Math.random())+ ++N+String(u)),r,n),t.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},T=tinymce.util.Tools.resolve("tinymce.util.Promise"),y=function(r){return new T(function(e){var n=new u.FileReader;n.onloadend=function(){e(n.result.split(",")[1])},n.readAsDataURL(r)})},S=tinymce.util.Tools.resolve("tinymce.Env"),x=tinymce.util.Tools.resolve("tinymce.util.Delay"),k=function(i){return new T(function(r){var t=u.document.createElement("input");t.type="file",t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0.001",u.document.body.appendChild(t),t.addEventListener("change",function(e){r(Array.prototype.slice.call(e.target.files))});var o=function(e){function n(){r([]),t.parentNode.removeChild(t)}S.os.isAndroid()&&"remove"!==e.type?x.setEditorTimeout(i,n,0):n(),i.off("focusin remove",o)};i.on("focusin remove",o),t.click()})},C=function(r){r.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){k(r).then(function(e){if(0<e.length){var n=e[0];y(n).then(function(e){w(r,e,n)})}})}}),r.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){E(r,2,2)}})},D=s(!1),_=s(!0),A=(b={fold:function(e){return e()},is:D,isSome:D,isNone:_,getOr:o,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:s(null),getOrUndefined:s(undefined),or:o,orThunk:t,map:n,each:e,bind:n,exists:D,forall:_,filter:n,equals:r,equals_:r,toArray:function(){return[]},toString:s("none()")},Object.freeze&&Object.freeze(b),b),R=function(r){function e(){return o}function n(e){return e(r)}var t=s(r),o={fold:function(e,n){return n(r)},is:function(e){return r===e},isSome:_,isNone:D,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(e){return R(e(r))},each:function(e){e(r)},bind:n,exists:n,forall:n,filter:function(e){return e(r)?o:A},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(e){return e.is(r)},equals_:function(e,n){return e.fold(D,function(e){return n(r,e)})}};return o},M={some:R,none:n,from:function(e){return null===e||e===undefined?A:R(e)}},I=function(e){if(null===e||e===undefined)throw new Error("Node cannot be null or undefined");return{dom:s(e)}},q={fromHtml:function(e,n){var r=(n||u.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw u.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return I(r.childNodes[0])},fromTag:function(e,n){var r=(n||u.document).createElement(e);return I(r)},fromText:function(e,n){var r=(n||u.document).createTextNode(e);return I(r)},fromDom:I,fromPoint:function(e,n,r){var t=e.dom();return M.from(t.elementFromPoint(n,r)).map(I)}},L=(u.Node.ATTRIBUTE_NODE,u.Node.CDATA_SECTION_NODE,u.Node.COMMENT_NODE,u.Node.DOCUMENT_NODE,u.Node.DOCUMENT_TYPE_NODE,u.Node.DOCUMENT_FRAGMENT_NODE,u.Node.ELEMENT_NODE),P=(u.Node.TEXT_NODE,u.Node.PROCESSING_INSTRUCTION_NODE,u.Node.ENTITY_REFERENCE_NODE,u.Node.ENTITY_NODE,u.Node.NOTATION_NODE,"undefined"!=typeof u.window?u.window:Function("return this;")(),i("string")),F=i("object"),U=i("array"),B=i("boolean"),j=i("undefined"),H=i("function");Array.prototype.slice;H(Array.from)&&Array.from;var X,z,G,W,Y,$,V,J,K,Q,Z,ee,ne,re,te,oe,ie,ue,se,ae=function(e){function n(){return r}var r=e;return{get:n,set:function(e){r=e},clone:function(){return ae(n())}}},ce=function(){return fe(0,0)},fe=function(e,n){return{major:e,minor:n}},de={nu:fe,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?ce():c(e,r)},unknown:ce},le="Firefox",me=function(e){var n=e.current;return{current:n,version:e.version,isEdge:f("Edge",n),isChrome:f("Chrome",n),isIE:f("IE",n),isOpera:f("Opera",n),isFirefox:f(le,n),isSafari:f("Safari",n)}},ge={unknown:function(){return me({current:undefined,version:de.unknown()})},nu:me,edge:s("Edge"),chrome:s("Chrome"),ie:s("IE"),opera:s("Opera"),firefox:s(le),safari:s("Safari")},he="Windows",ve="Android",pe="Solaris",be="FreeBSD",Oe="ChromeOS",Ne=function(e){var n=e.current;return{current:n,version:e.version,isWindows:d(he,n),isiOS:d("iOS",n),isAndroid:d(ve,n),isOSX:d("OSX",n),isLinux:d("Linux",n),isSolaris:d(pe,n),isFreeBSD:d(be,n),isChromeOS:d(Oe,n)}},Ee={unknown:function(){return Ne({current:undefined,version:de.unknown()})},nu:Ne,windows:s(he),ios:s("iOS"),android:s(ve),linux:s("Linux"),osx:s("OSX"),solaris:s(pe),freebsd:s(be),chromeos:s(Oe)},we=function(e,r){return l(e,r).map(function(e){var n=de.detect(e.versionRegexes,r);return{current:e.name,version:n}})},Te=function(e,r){return l(e,r).map(function(e){var n=de.detect(e.versionRegexes,r);return{current:e.name,version:n}})},ye=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return m(e,"edge/")&&m(e,"chrome")&&m(e,"safari")&&m(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ye],search:function(e){return m(e,"chrome")&&!m(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return m(e,"msie")||m(e,"trident")}},{name:"Opera",versionRegexes:[ye,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:g("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:g("firefox")},{name:"Safari",versionRegexes:[ye,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(m(e,"safari")||m(e,"mobile/"))&&m(e,"applewebkit")}}],xe=[{name:"Windows",search:g("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return m(e,"iphone")||m(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:g("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:g("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:g("linux"),versionRegexes:[]},{name:"Solaris",search:g("sunos"),versionRegexes:[]},{name:"FreeBSD",search:g("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:g("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ke={browsers:s(Se),oses:s(xe)},Ce=ae((z=u.navigator.userAgent,G=function(e){return u.window.matchMedia(e).matches},oe=ke.browsers(),ie=ke.oses(),ue=we(oe,z).fold(ge.unknown,ge.nu),se=Te(ie,z).fold(Ee.unknown,Ee.nu),{browser:ue,os:se,deviceType:(W=se,Y=ue,$=z,V=G,J=W.isiOS()&&!0===/ipad/i.test($),K=W.isiOS()&&!J,Q=W.isiOS()||W.isAndroid(),Z=Q||V("(pointer:coarse)"),ee=J||!K&&Q&&V("(min-device-width:768px)"),ne=K||Q&&!ee,re=Y.isSafari()&&W.isiOS()&&!1===/safari/i.test($),te=!ne&&!ee&&!re,{isiPad:s(J),isiPhone:s(K),isTablet:s(ee),isPhone:s(ne),isTouch:s(Z),isAndroid:W.isAndroid,isiOS:W.isiOS,isWebView:s(re),isDesktop:s(te)})})),De=L,_e=(Ce.get().browser.isIE(),{getToolbarItemsOr:(X=P,function(e,n,r){return function(){if(!X(r))throw new Error("Default value doesn't match requested type.")}(),function(e,n){if(U(e)||F(e))throw new Error("expected a string but found: "+e);return j(e)?n:B(e)?!1===e?"":n:e}(e.getParam(n,r),r)})}),Ae=function(e){return _e.getToolbarItemsOr(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")},Re=function(e){return _e.getToolbarItemsOr(e,"quickbars_insert_toolbar","quickimage quicktable")},Me=function(e){return _e.getToolbarItemsOr(e,"quickbars_image_toolbar","alignleft aligncenter alignright")},Ie=function(o){var e=Re(o);0<e.trim().length&&o.ui.registry.addContextToolbar("quickblock",{predicate:function(e){function n(e){return e.dom()===o.getBody()}var r=q.fromDom(e),t=o.schema.getTextBlockElements();return a(h,p,r,"table",n).fold(function(){return a(function(e,n){return n(e)},v,r,function(e){return e.dom().nodeName.toLowerCase()in t&&o.dom.isEmpty(e.dom())},n).isSome()},function(){return!1})},items:e,position:"line",scope:"editor"})},qe=function(r){function t(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)}var e=Me(r);0<e.trim().length&&r.ui.registry.addContextToolbar("imageselection",{predicate:t,items:e,position:"node"});var n=Ae(r);0<n.trim().length&&r.ui.registry.addContextToolbar("textselection",{predicate:function(e){return!t(e)&&!r.selection.isCollapsed()&&(n=e,"false"!==r.dom.getContentEditableParent(n));var n},items:n,position:"selection",scope:"editor"})};!function Le(){O.add("quickbars",function(e){C(e),Ie(e),qe(e)})}()}(window);